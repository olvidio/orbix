<style>
	table  {
		width : 600px;	
	 }
	.contenido  {
		font-weight : bold;	
	 }
	.link  {
		text-decoration : none;
		color : blue;
		cursor: pointer;
	 }
</style>
<!-- jQuery -->
<script type="text/javascript" src='<?= core\ConfigGlobal::$web_scripts.'/jquery/jquery-1.12.3.min.js'; ?>'></script>
<script>
fnjs_guardar=function(formulario,que){
	if (que=="eliminar") {
		seguro=confirm("<?= $txt_eliminar ?>");
		if (seguro) { 
			err=0;
		} else {
			err=1;
		}
	}
	var err=0;
	var tar=$('#id_tarifa').val();
	var id_tipo_activ=$('#id_tipo_activ').val();
	if (!id_tipo_activ) {
		var isfsv=$('#isfsv_val').val();
		var iasistentes=$('#iasistentes_val').val();
		var iactividad=$('#iactividad_val').val();
		var inom_tipo=$('#inom_tipo_val').val();
		//alert ("s: "+sfsv+", as: "+asistentes+", act: "+actividad+", tip: "+id_tipo_activ);
		if (!isfsv || !iasistentes || !iactividad ) { alert ("<?= _("debe indicar el tipo de actividad") ?>"); err=1; }
		if (!inom_tipo && !err) {
		   id_tipo_activ=isfsv+iasistentes+iactividad+"000";
	   	} else {
		   id_tipo_activ=isfsv+iasistentes+iactividad+inom_tipo;
		}
		//alert ("tipo: "+id_tipo_activ +" err: "+err);
	}
	if (!tar) { alert ("<?= _("debe indicar la tarifa") ?>"); err=1; }
	if (!err) {
		$('#id_tipo_activ').val(id_tipo_activ);
		$('#que').val(que);
		$(formulario).attr('action','<?= core\ConfigGlobal::getWeb() ?>/apps/actividadtarifas/controller/actividad_tarifa_tipo_ajax.php');
		$(formulario).submit(function() {
			$.ajax({
				url: $(this).attr('action'),
				type: 'post',
				data: $(this).serialize()
			})
			.done(function (rta_txt) {
				if (rta_txt != '' && rta_txt != '\n') {
					alert (rta_txt);
				} else {
					fnjs_ver();
					fnjs_cerrar();
				}
			});
			return false;
		});
		$(formulario).submit();
		$(formulario).off();
	}
}
</script>
<form id="modifica">
<?= $oHash->getCamposHtml(); ?>
<input type=hidden id="que" name="que" value="">
<table><tr>
    <td class=etiqueta><?= _("tipo de actividad") ?>:</td>
    <td class=contenido><?= $oTipoActiv->getNom(); ?> - <?= $txt_temporada ?></td>
    <td class=etiqueta><?= _("tarifa") ?>:</td><td>
    <?= $oDesplPosiblesTipoTarifas->desplegable(); ?>
    </td>
</tr>
</table>
<br><br>
<input type="button" value="<?= _("guardar") ?>" onclick="fnjs_guardar('#modifica','update');">
<input type="button" value="<?= _("eliminar") ?>" onclick="fnjs_guardar('#modifica','eliminar');" >
<input type="button" value="<?= _("cancel") ?>" onclick="fnjs_cerrar();" >
</form>
