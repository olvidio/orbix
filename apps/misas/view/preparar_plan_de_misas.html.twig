<div id="div_nuevo_periodo">
    <form id="frm_nuevo_periodo" name="frm_nuevo_periodo" action="" method="post">
        {{ oHash.getCamposHtml|raw }}
        <table>
            <thead>
            <tr>
                <th class=titulo_inv colspan=4>{{ "Preparar Misas de la zona"|trans|capitalize }}:&nbsp;&nbsp;&nbsp;
                    {{ oDesplZonas.desplegable|raw }}
                </th>
                <th class=titulo_inv colspan=4>{{ "Tipo de plantilla"|trans|capitalize }}:&nbsp;&nbsp;&nbsp;
                    {{ oDesplTipoPlantilla.desplegable|raw }}
                </th>
            </tr>
            <tr>
                {{ oFormP.getTd()|raw }}   
            </tr>
            <tr>
                <td>
                    <input type=button name="preparar" value="preparar" onclick="fnjs_nuevo_periodo();"><br>
                    Borrar√° todos los datos introducidos en este periodo!!
                </td>
            </tr>
            <tr>
            </tr>
            </thead>
        </table>
    </form>
</div>

<br>
<div id="div_cuadricula">
</div>

<script>
    $("#empiezamin").datepicker();
    $("#empiezamax").datepicker();
    $("#periodo").datepicker();

    fnjs_ver_cuadricula_zona = function () {
        alert('ver_cuadricula_zona');
        let id_zona = $('#id_zona').val();
        alert('id_zona:'+id_zona);
        if (id_zona) {
            let url = '{{ url_ver_cuadricula_zona }}';
	        var zona=$('#sacd_zona').prop('checked');
    	    var periodo=$('#periodo').val();
    	    var empiezamax=$('#empiezamax').val();
    	    var empiezamin=$('#empiezamin').val();
            let orden = $('#orden').val();

            let parametros = 'id_zona=' + id_zona + '&periodo=' + periodo + '&empiezamin=' + empiezamin + '&empiezamax=' + empiezamax + '&orden=' + orden + '&tipo_plantilla=p' + '{{ h_zona_plantilla|raw }}';

            $.ajax({
                url: url,
                type: 'post',
                data: parametros,
                dataType: 'html'
            })
                .done(function (rta_txt) {
                    $('#div_cuadricula').html(rta_txt);
                });
        }
    }

    fnjs_nuevo_periodo = function () {
        alert('fnjs_nuevo_periodo');
        let id_zona = $('#id_zona').val();
        alert('id_zona:'+id_zona);
        let tipoplantilla = $('#tipoplantilla').val();
        alert('tipoplantilla:'+tipoplantilla);
        if (id_zona) {
            let url = '{{ url_crear_nuevo_periodo }}';
        alert('url:'+url);

    	    var periodo=$('#periodos').val();
        alert('periodo:'+periodo);
    	    var empiezamax=$('#empiezamax').val();
        alert('empiezamax:'+empiezamax);
    	    var empiezamin=$('#empiezamin').val();
        alert('empiezamin:'+empiezamin);
        }
   	    var periodo=$('#periodos').val();
        alert(periodo);
        fnjs_ver_cuadricula_zona();
    }
</script>
