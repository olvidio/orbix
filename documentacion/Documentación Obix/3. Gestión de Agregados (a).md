# üë§ Grupo 3: Gesti√≥n de Agregados (a)

Este grupo re√∫ne las entradas del men√∫ relacionadas con agregados (a): sincronizaci√≥n BDU, gesti√≥n de actividades (CRT/CV/CVE) y planificaci√≥n.

> Nota: cada entrada del men√∫ tiene una URL (punto de entrada). Los posibles pasos posteriores se describen en el **mapa** correspondiente dentro de `documentacion/Documentaci√≥n Obix/`.

---

## 1) Ra√≠z y sincronizaci√≥n

### 1.1 Ra√≠z base
- **Entrada (men√∫):** `buscar n (Raiz base)`
- **URL:** *(sin URL en `menus.csv`)*

### 1.2 Sincronizar con BDU
- **Entrada (men√∫):** `apps/dbextern/controller/sincro_index.php`  
  **Par√°metros:** `tipo=a`
- **Mapa:** [[dbextern/mapa_sincro_index]]
- **Acciones seg√∫n mapa:**
  - El mapa est√° vac√≠o (sin flujo documentado). Si hay acciones internas, faltan en el mapa.

---

## 2) Actividades de agregados (CRT / CV / CVE)

Las ramas CRT, CV y CVE comparten patr√≥n: importar, buscar/listar, listar por centro, pendientes, plazas y cambio de fase. Cuando el flujo comienza en `*_que.php`, suele existir un `*_select.php` asociado (aunque el mapa no lo muestre).

### 2.1 CRT

#### 2.1.1 Importar CRT
- **Entrada (men√∫):** `apps/actividades/controller/actividad_que.php`  
  **Par√°metros:** `sasistentes=agd&sactividad=crt&que=ver&modo=importar`
- **Mapa:** [[actividades/mapa_actividad_que]]
- **Acciones seg√∫n mapa:**
  - Vista `actividad_que.html.twig`.
  - Llamadas a `actividad_tipo_get.php`, `lista_activ.php`, `actividad_que.php` (recarga), `actividad_que_fases_ajax.php`.

#### 2.1.2 Buscar CRT
- **Entrada (men√∫):** `apps/actividades/controller/actividad_select.php`  
  **Par√°metros:** `sasistentes=agd&sactividad=crt&que=ver`
- **Mapa:** [[actividades/mapa_actividad_select]]
- **Acciones seg√∫n mapa (directas + JS):**
  - Vista `actividad_select.phtml`.
  - Posibles pasos a `actividad_update.php`, `actividad_que.php`, `actividad_ver.php`.
  - Acciones JS: `actividad_proceso.php`, `lista_clases_ca.php`, `posibles_asignaturas_ca.php`, `plan_estudios_ca.php`, `dossiers_ver.php`, `tabla_peticiones.php`, `resumen_plazas.php`, `lista_asistentes.php`, `historics.php`.
- **Mapa relacionado:** [[actividades/mapa_actividad_ver]] (cuando se abre/edita una actividad).

#### 2.1.3 Listar varios CRT
- **Entrada (men√∫):** `apps/actividades/controller/actividad_que.php`  
  **Par√°metros:** `sasistentes=agd&sactividad=crt&que=list_cjto`
- **Mapa:** [[actividades/mapa_actividad_que]]
- **Acciones seg√∫n mapa:**
  - Igual que 2.1.1.

#### 2.1.4 Listar por centro (CRT)
- **Entrada (men√∫):** `apps/asistentes/controller/que_ctr_lista.php`  
  **Par√°metros:** `lista=list_activ&n_agd=a&sasistentes=agd&sactividad=crt`
- **Mapa:** [[asistentes/mapa_que_ctr_lista]]
- **Acciones seg√∫n mapa:**
  - Vista `que_ctr_lista.phtml`.
  - Referencia a `lista_profesion.php` (destino no resuelto en el mapa).

#### 2.1.5 Gesti√≥n de plazas (CRT)
- **Entrada (men√∫):** `apps/actividadplazas/controller/gestion_plazas.php`  
  **Par√°metros:** `sasistentes=agd&sactividad=crt`
- **Mapa:** [[actividadplazas/mapa_gestion_plazas]]
- **Acciones seg√∫n mapa:**
  - Vista `gestion_plazas.phtml`.
  - Reenv√≠o a `gestion_plazas.php` (recarga).

#### 2.1.6 Balance de plazas (CRT)
- **Entrada (men√∫):** `apps/actividadplazas/controller/plazas_balance_que.php`  
  **Par√°metros:** `sasistentes=agd&sactividad=crt`
- **Mapa:** [[actividadplazas/mapa_plazas_balance_que]]
- **Acciones seg√∫n mapa:**
  - Vista `plazas_balance_que.phtml`.
  - Paso a `plazas_balance_dl.php` y su vista `plazas_balance_dl.phtml`.

#### 2.1.7 Incorporar 1¬™ petici√≥n (CRT)
- **Entrada (men√∫):** `apps/actividadplazas/controller/incorporar_peticion.php`  
  **Par√°metros:** `sasistentes=agd&sactividad=crt`
- **Mapa:** [[actividadplazas/mapa_incorporar_peticion]]
- **Acciones seg√∫n mapa:**
  - El mapa est√° vac√≠o (sin flujo documentado). Si hay acciones internas, faltan en el mapa.

#### 2.1.8 Cambiar de fase (CRT)
- **Entrada (men√∫):** `apps/procesos/controller/fases_activ_cambio.php`  
  **Par√°metros:** `id_tipo_activ=131`
- **Mapa:** [[procesos/mapa_fases_activ_cambio]]
- **Acciones seg√∫n mapa:**
  - Vista `fases_activ_cambio.html.twig`.
  - Pasos a `actividad_proceso.php` y `fases_activ_cambio_ajax.php`.
  - Desde `actividad_proceso.php`: `actividad_proceso_ajax.php` y `dossiers_ver.php`.

### 2.2 CV

#### 2.2.1 Importar CV
- **Entrada (men√∫):** `apps/actividades/controller/actividad_que.php`  
  **Par√°metros:** `sasistentes=agd&sactividad=cv&que=ver&modo=importar`
- **Mapa:** [[actividades/mapa_actividad_que]]
- **Acciones seg√∫n mapa:**
  - Igual que 2.1.1.

#### 2.2.2 Buscar CV
- **Entrada (men√∫):** `apps/actividades/controller/actividad_select.php`  
  **Par√°metros:** `sasistentes=agd&sactividad=cv&que=ver`
- **Mapa:** [[actividades/mapa_actividad_select]]
- **Acciones seg√∫n mapa:**
  - Igual que 2.1.2.

#### 2.2.3 Listar varias CV
- **Entrada (men√∫):** `apps/actividades/controller/actividad_que.php`  
  **Par√°metros:** `sasistentes=agd&sactividad=cv&que=list_cjto`
- **Mapa:** [[actividades/mapa_actividad_que]]
- **Acciones seg√∫n mapa:**
  - Igual que 2.1.1.

#### 2.2.4 Listar por centros (CV)
- **Entrada (men√∫):** `apps/asistentes/controller/que_ctr_lista.php`  
  **Par√°metros:** `lista=list_activ&n_agd=a&sasistentes=agd&sactividad=cv`
- **Mapa:** [[asistentes/mapa_que_ctr_lista]]
- **Acciones seg√∫n mapa:**
  - Igual que 2.1.4.

#### 2.2.5 Pendientes (CV)
- **Entrada (men√∫):** `apps/asistentes/controller/activ_pendientes_select.php`  
  **Par√°metros:** `sactividad=ca&tipo_personas=agd`
- **Mapa:** [[asistentes/mapa_activ_pendientes_select]]
- **Acciones seg√∫n mapa:**
  - Vista `activ_pendientes.phtml`.
- **Nota:** el par√°metro `sactividad=ca` aparece as√≠ en `menus.csv` para este grupo.

#### 2.2.6 Gesti√≥n de plazas (CV)
- **Entrada (men√∫):** `apps/actividadplazas/controller/gestion_plazas.php`  
  **Par√°metros:** `sasistentes=agd&sactividad=cv`
- **Mapa:** [[actividadplazas/mapa_gestion_plazas]]
- **Acciones seg√∫n mapa:**
  - Igual que 2.1.5.

#### 2.2.7 Balance de plazas (CV)
- **Entrada (men√∫):** `apps/actividadplazas/controller/plazas_balance_que.php`  
  **Par√°metros:** `sasistentes=agd&sactividad=cv`
- **Mapa:** [[actividadplazas/mapa_plazas_balance_que]]
- **Acciones seg√∫n mapa:**
  - Igual que 2.1.6.

#### 2.2.8 Incorporar 1¬™ petici√≥n (CV)
- **Entrada (men√∫):** `apps/actividadplazas/controller/incorporar_peticion.php`  
  **Par√°metros:** `sasistentes=agd&sactividad=cv`
- **Mapa:** [[actividadplazas/mapa_incorporar_peticion]]
- **Acciones seg√∫n mapa:**
  - Igual que 2.1.7.

#### 2.2.9 Cambiar de fase (CV)
- **Entrada (men√∫):** `apps/procesos/controller/fases_activ_cambio.php`  
  **Par√°metros:** `sasistentes=agd&sactividad=ca`
- **Mapa:** [[procesos/mapa_fases_activ_cambio]]
- **Acciones seg√∫n mapa:**
  - Igual que 2.1.8.
- **Nota:** el par√°metro `sactividad=ca` aparece as√≠ en `menus.csv` para este grupo.

### 2.3 CVE

#### 2.3.1 Buscar CVE
- **Entrada (men√∫):** `apps/actividades/controller/actividad_select.php`  
  **Par√°metros:** `sasistentes=agd&sactividad=cve`
- **Mapa:** [[actividades/mapa_actividad_select]]
- **Acciones seg√∫n mapa:**
  - Igual que 2.1.2.

#### 2.3.2 Importar CVE
- **Entrada (men√∫):** `apps/actividades/controller/actividad_que.php`  
  **Par√°metros:** `sasistentes=agd&sactividad=cve&que=ver&modo=importar`
- **Mapa:** [[actividades/mapa_actividad_que]]
- **Acciones seg√∫n mapa:**
  - Igual que 2.1.1.

#### 2.3.3 Gesti√≥n de plazas (CVE)
- **Entrada (men√∫):** `apps/actividadplazas/controller/gestion_plazas.php`  
  **Par√°metros:** `sasistentes=agd&sactividad=cve`
- **Mapa:** [[actividadplazas/mapa_gestion_plazas]]
- **Acciones seg√∫n mapa:**
  - Igual que 2.1.5.

#### 2.3.4 Cambiar de fase (CVE)
- **Entrada (men√∫):** `apps/procesos/controller/fases_activ_cambio.php`  
  **Par√°metros:** `sasistentes=agd&sactividad=cve`
- **Mapa:** [[procesos/mapa_fases_activ_cambio]]
- **Acciones seg√∫n mapa:**
  - Igual que 2.1.8.

---

## 3) Planning / planificaci√≥n

### 3.1 Planning por persona (agregados)
- **Entrada (men√∫):** `apps/planning/controller/planning_persona_que.php`  
  **Par√°metros:** `obj_pau=PersonaDl`
- **Mapa:** [[planning/mapa_planning_persona_que]]
- **Acciones seg√∫n mapa:**
  - Vista `planning_persona_que.phtml`.
  - `planning_persona_select.php` ‚Üí vista `planning_persona_select.phtml`.
  - Desde selecci√≥n: `planning_persona_ver.php` y `dossiers_ver.php`.

### 3.2 Planning por centro
- **Entrada (men√∫):** `apps/planning/controller/planning_ctr_que.php`
- **Mapa:** [[planning/mapa_planning_ctr_que]]
- **Acciones seg√∫n mapa:**
  - Vista `planning_ctr_que.phtml`.
  - Paso a `planning_ctr_select.php` ‚Üí vista `planning_ctr_select.phtml`.

### 3.3 Planning por casa
- **Entrada (men√∫):** `apps/planning/controller/planning_casa_que.php`
- **Mapa:** [[planning/mapa_planning_casa_que]]
- **Acciones seg√∫n mapa:**
  - Vista `planning_casa_que.phtml`.
  - Paso a `planning_casa_select.php` ‚Üí vista `planning_casa_select.phtml`.
